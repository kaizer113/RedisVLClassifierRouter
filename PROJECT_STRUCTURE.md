# Project Structure

This document describes the organization and purpose of files in the RedisVL Classifier Router project.

## Directory Structure

```
RedisVLClassifierRouter/
├── .github/
│   └── workflows/
│       └── ci.yml                          # GitHub Actions CI/CD pipeline
├── .venv/                                  # Virtual environment (not in git)
├── __pycache__/                            # Python cache (not in git)
├── 1_baseline_with_openai.py               # Script 1: Pure GPT-4 classification
├── 2_RedisVLRouter.py                      # Script 2: RedisVL semantic router
├── 3_RedisVLRouterwithChatGPT.py           # Script 3: Hybrid approach
├── 4_RedisVLRouterWithOptimizer.py         # Script 4: Optimized router (recommended)
├── BBC News Test.csv                       # Test dataset
├── BBC News Train.csv                      # Training/test dataset
├── BBC News Train2.csv                     # Reference articles dataset
├── CONTRIBUTING.md                         # Contribution guidelines
├── LICENSE                                 # MIT License
├── README.md                               # Main documentation
├── README_OPTIMIZER.md                     # Threshold optimization guide
├── SETUP.md                                # Detailed setup instructions
├── PROJECT_STRUCTURE.md                    # This file
├── config.example.py                       # Template for API keys
├── config.py                               # API keys (not in git)
├── main.py                                 # Entry point (if needed)
├── pyproject.toml                          # Project metadata and dependencies
├── quickstart.sh                           # Quick setup script
├── test_distance_threshold.py              # Testing script for thresholds
└── uv.lock                                 # Locked dependency versions
```

## Core Scripts

### 1_baseline_with_openai.py
**Purpose:** Baseline classification using pure GPT-4  
**Use Case:** Establish accuracy benchmark and cost baseline  
**Key Features:**
- Direct OpenAI API calls
- No caching or optimization
- Measures accuracy, latency, and cost

**When to use:** When you need highest accuracy and cost is not a concern

### 2_RedisVLRouter.py
**Purpose:** Fast vector-based classification using RedisVL  
**Use Case:** Local, cost-free classification with semantic routing  
**Key Features:**
- Vector similarity search
- COSINE distance metric
- Returns "unknown" for low-confidence matches

**When to use:** When you need fast, free classification and can handle some unknowns

### 3_RedisVLRouterwithChatGPT.py
**Purpose:** Hybrid approach combining RedisVL + ChatGPT fallback  
**Use Case:** Balance between speed, cost, and accuracy  
**Key Features:**
- Tries RedisVL first (fast, free)
- Falls back to ChatGPT for unknowns
- Learns from ChatGPT classifications
- Adds new references to router

**When to use:** Production use with cost optimization

### 4_RedisVLRouterWithOptimizer.py ⭐ (Recommended)
**Purpose:** Automatic threshold optimization for best performance  
**Use Case:** Optimal classification with minimal manual tuning  
**Key Features:**
- Uses `RouterThresholdOptimizer`
- Finds best threshold per category
- Evaluates with F1/precision/recall
- Random search optimization

**When to use:** When you want the best performance with minimal configuration

## Configuration Files

### pyproject.toml
**Purpose:** Project metadata and dependencies  
**Contains:**
- Package name and version
- Python version requirement (>=3.11)
- Dependencies list
- Optional dev dependencies
- Build system configuration
- Ruff linting configuration

### uv.lock
**Purpose:** Locked dependency versions  
**Generated by:** `uv sync`  
**Contains:** Exact versions of all dependencies and sub-dependencies  
**Why:** Ensures reproducible builds across environments

### config.py (Not in Git)
**Purpose:** Store API keys and secrets  
**Contains:**
- `OPENAI_API_KEY`
- Other sensitive configuration

**⚠️ Security:** Never commit this file! Use `config.example.py` as template

### config.example.py
**Purpose:** Template for config.py  
**Usage:** Copy to `config.py` and fill in actual values

## Documentation Files

### README.md
**Purpose:** Main project documentation  
**Contains:**
- Project overview
- Quick start guide
- Installation instructions
- Usage examples
- Performance comparison
- Configuration options

**Audience:** All users

### README_OPTIMIZER.md
**Purpose:** Detailed threshold optimization guide  
**Contains:**
- How optimization works
- Parameter explanations
- Expected results
- Benefits and use cases

**Audience:** Users wanting to understand optimization

### SETUP.md
**Purpose:** Step-by-step setup instructions  
**Contains:**
- Prerequisites
- Installation steps for all platforms
- Troubleshooting guide
- Verification steps

**Audience:** New users setting up for the first time

### CONTRIBUTING.md
**Purpose:** Guidelines for contributors  
**Contains:**
- Development setup
- Code style guidelines
- PR process
- Areas for contribution

**Audience:** Contributors and developers

### PROJECT_STRUCTURE.md
**Purpose:** Project organization reference  
**Contains:** This document

**Audience:** Developers and contributors

## Dataset Files

### BBC News Train2.csv
**Purpose:** Reference articles for building semantic routes  
**Size:** ~1500 articles  
**Usage:** Loaded by all scripts to create route references  
**Format:**
```csv
ArticleId,Text,Category
1,"Article text...",business
```

### BBC News Train.csv
**Purpose:** Test articles for evaluation  
**Size:** ~1000 articles  
**Usage:** Used for testing classification accuracy  
**Format:** Same as Train2.csv

### BBC News Test.csv
**Purpose:** Additional test set  
**Size:** Variable  
**Usage:** Optional additional testing

## Utility Files

### test_distance_threshold.py
**Purpose:** Experiment with different distance thresholds  
**Usage:** `python test_distance_threshold.py`  
**Output:** Shows which queries match at different threshold values

### quickstart.sh
**Purpose:** Automated setup script  
**Usage:** `./quickstart.sh`  
**Features:**
- Checks for uv installation
- Verifies Redis is running
- Installs dependencies
- Creates config.py from template
- Runs verification tests

### main.py
**Purpose:** Entry point for the application (if needed)  
**Status:** Optional, can be used for CLI interface

## GitHub Files

### .github/workflows/ci.yml
**Purpose:** Continuous Integration pipeline  
**Triggers:** Push to main/develop, Pull requests  
**Jobs:**
- Lint: Code formatting and style checks
- Test: Syntax validation and Redis connectivity

### .gitignore
**Purpose:** Specify files to exclude from Git  
**Excludes:**
- Virtual environments (.venv/)
- Python cache (__pycache__/)
- API keys (config.py)
- IDE files (.vscode/, .idea/)
- Logs and temporary files

### LICENSE
**Purpose:** MIT License for the project  
**Allows:** Free use, modification, distribution

## Dependencies

### Core Dependencies (pyproject.toml)

```toml
dependencies = [
    "numpy>=2.3.4",                      # Numerical computing
    "openai>=2.7.1",                     # OpenAI API client
    "redisvl>=0.10.0",                   # Redis vector library
    "sentence-transformers>=5.1.2",      # Text embeddings
    "redis-retrieval-optimizer>=0.4.0",  # Threshold optimization
]
```

### Optional Dependencies

```toml
[project.optional-dependencies]
dev = [
    "pytest>=7.0.0",    # Testing framework
    "ruff>=0.1.0",      # Linting and formatting
]
```

## File Sizes (Approximate)

| File | Size | Type |
|------|------|------|
| BBC News Train2.csv | ~5 MB | Data |
| BBC News Train.csv | ~3 MB | Data |
| BBC News Test.csv | ~2 MB | Data |
| .venv/ | ~2 GB | Dependencies |
| uv.lock | ~100 KB | Config |
| All scripts | ~50 KB | Code |
| Documentation | ~100 KB | Docs |

## Important Notes

### Files NOT in Git (.gitignore)

- `.venv/` - Virtual environment
- `__pycache__/` - Python cache
- `config.py` - API keys
- `*.log` - Log files
- `.DS_Store` - macOS files
- `.ruff_cache/` - Ruff cache

### Files TO Commit

- All `.py` scripts
- All `.md` documentation
- `pyproject.toml` and `uv.lock`
- `config.example.py` (template only)
- Dataset CSV files
- `.github/workflows/` CI configuration
- `LICENSE`

## Maintenance

### Regular Updates

1. **Dependencies:** Run `uv sync --upgrade` periodically
2. **Documentation:** Keep README.md updated with new features
3. **Lock file:** Commit `uv.lock` after dependency changes
4. **CI:** Ensure GitHub Actions pass on all PRs

### Before Committing

1. Check `.gitignore` is working: `git status`
2. Verify no secrets in code: `grep -r "sk-" *.py`
3. Run linter: `ruff check .`
4. Format code: `ruff format .`

---

**Last Updated:** 2025-11-07

